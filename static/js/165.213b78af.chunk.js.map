{"version":3,"file":"static/js/165.213b78af.chunk.js","mappings":"wOAeA,SAASA,EAAT,GAA8E,IAA/DC,EAA8D,EAA9DA,GAAIC,EAA0D,EAA1DA,GAAIC,EAAsD,EAAtDA,GAAIC,EAAkD,EAAlDA,OAAQC,EAA0C,EAA1CA,eAAgBC,EAA0B,EAA1BA,gBAAiBC,EAAS,EAATA,QAE5DC,GAAWC,EAAAA,EAAAA,UAAQ,WAEvB,IAAMC,EAAQ,IAAIC,EAAAA,QAAcV,EAAIC,EAAIC,GAClCS,EAAM,IAAID,EAAAA,QAAcV,EAAIC,EAAI,GAGtC,OAFiB,IAAIS,EAAAA,gBAAuBE,cAAc,CAACH,EAAOE,MAIjE,CAACR,IAEJ,OAEI,iBACAU,cAAeR,EACfS,aAAcV,EAEZW,SAAU,SAACC,GAAUA,EAAKC,wBAC1BV,SAAUA,EALZ,UASI,+BACEW,MAAM,QACNC,QAASb,EAAU,GAAM,GACzBc,aAAa,EACbC,UAAW,EACXC,MAAO,EACPC,SAAU,GACVC,QAAS,OAUrB,SAASC,EAAT,GAA0D,IAAzCzB,EAAwC,EAAxCA,GAAIC,EAAoC,EAApCA,GAAIC,EAAgC,EAAhCA,GAAIwB,EAA4B,EAA5BA,OAAQC,EAAoB,EAApBA,QAASxB,EAAW,EAAXA,OAAQyB,EAAG,EAAHA,EAEpD,GAA4BC,EAAAA,EAAAA,WAAS,GAArC,eAAOvB,EAAP,KAAgBwB,EAAhB,KACA,GAA4BD,EAAAA,EAAAA,WAAS,kBCtDCE,EDsD6B,IAAKrB,EAAAA,mBCrDjEsB,EAAAA,EAAAA,IACLD,EACAE,OAAOC,OACL,CACEC,gBAAgB,gVAYlBC,IAjBC,IAAiCL,EAAcK,KDsD7CC,GAAP,eAMA,OAJAC,EAAAA,EAAAA,YAAU,WACRC,SAASC,KAAKC,MAAMC,OAASpC,EAAU,UAAY,SAClD,CAACA,KAIF,UAAC,WAAD,YACQ,SAACqC,EAAA,EAAD,CACAC,QAAQ,OACRC,SAAU,EACVC,SAAU,CAAC9C,EAAIC,EAAIC,GACnBgB,MAAOQ,EACPqB,SAAUV,EAEVW,aAAc,EACdC,eAAgB,GAChBC,eAAgB,GAChBC,eAAgB,GAChBC,YAAa,GACbC,eAAgB/C,EAAS,GAAM,EAC/BgD,aAAc5B,EAGdb,cAAe,SAAC0C,GAAD,OAAWzB,GAAS,IACnChB,aAAc,SAACyC,GAAD,OAAWzB,GAAS,IAjBlC,SAmBCH,KAEL,SAAC5B,EAAD,CAAMC,GAAIA,EAAIC,GAAIA,EAAIC,GAAIA,EAAsBC,OAAQA,EAElDE,gBAAiB,SAACkD,GAAD,OAAWzB,GAAS,IACrC1B,eAAgB,SAACmD,GAAD,OAAWzB,GAAS,IACpCxB,QAAWA,GAJjB,eAA2CsB,OA2CnD,MAhCA,YAAyB,IAATzB,EAAQ,EAARA,OAGRqD,GAAgBC,EAAAA,EAAAA,IAAWC,EAAMvD,GAGjCwD,EAAW,GAiBf,OAdEH,EAAcI,SAAQ,SAACC,EAAGjC,GAEtB,IAAI5B,IAAO8D,EAAAA,EAAAA,IAASD,EAAEE,MAClB9D,GAAK+D,EAAAA,EAAAA,IAAQH,EAAEI,KACf/D,GAAKgE,EAAAA,EAAAA,IAAML,EAAEM,MACbzC,EAAS0C,EAAAA,GAAWP,EAAEQ,OAE1BV,EAASW,MACP,SAAC7C,EAAD,CAAQzB,GAAIA,EAAIC,GAAIA,EAAIC,GAAIA,EAAsBwB,OAAQA,EAAQC,QAASkC,EAAEU,OAAQpE,OAAQA,EAAQyB,EAAGA,GAAxG,eAA6CA,SAOjD,SAAC,WAAD,UAEG+B","sources":["components/Texts.js","utils/createBillboardMaterial.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useContext, useRef, lazy, Suspense } from 'react';\n\nimport { Canvas, useFrame, extend, useThree } from '@react-three/fiber'\nimport { meshBounds, Text } from \"@react-three/drei\";\nimport * as THREE from 'three'\n\n\n\nimport { createBillboardMaterial } from '../utils/createBillboardMaterial'\nimport { normLat, normLong, normZ, groupColor } from \"../utils/helper\"\nimport { filterData } from '../utils/helper';\n\nimport data from \"../data/mydata.json\"\n\n\nfunction Line({pX, pY, pZ, filter, handlePointOut, handlePointOver, hovered}){\n\n  const geometry = useMemo(()=>{\n\n    const start = new THREE.Vector3(pX, pY, pZ )\n    const end = new THREE.Vector3(pX, pY, 0 )\n    const geometry = new THREE.BufferGeometry().setFromPoints([start, end])\n\n    return geometry\n\n  }, [filter])\n\n  return(\n  \n      <line \n      onPointerOver={handlePointOver}\n      onPointerOut={handlePointOut}\n\n        onUpdate={(line) =>{ line.computeLineDistances()}}\n        geometry={geometry}>\n\n                  \n     \n          <lineDashedMaterial \n            color=\"black\"\n            opacity={hovered ? 0.8 : 0.3}\n            transparent={true}\n            linewidth={1}\n            scale={2}\n            dashSize={0.5}\n            gapSize={0.5}\n          />\n      </line>\n\n  )\n\n}\n\n\n\nfunction MyText({pX, pY, pZ, pColor, content, filter, i}){\n\n  const [hovered, setHover] = useState(false)\n  const [billboardMaterial] = useState(() => createBillboardMaterial(new  THREE.MeshBasicMaterial()))\n  \n  useEffect(() => {\n    document.body.style.cursor = hovered ? 'pointer' : 'auto'\n  }, [hovered])\n\n  return(\n\n    <React.Fragment>\n            <Text \n            anchorX='left' \n            fontSize={1} \n            position={[pX, pY, pZ]} \n            color={pColor}\n            material={billboardMaterial} \n\n            outlineWidth={0}\n            outlineOffsetX={.1}\n            outlineOffsetY={.1}\n            outlineOffsetZ={.1}\n            outlineBlur={.5}\n            outlineOpacity={hovered? 0.4 : 0}\n            outlineColor={pColor}\n\n         \n            onPointerOver={(event) => setHover(true)}\n            onPointerOut={(event) => setHover(false)}>\n\n            {content}\n        </Text>\n        <Line pX={pX} pY={pY} pZ={pZ} key={`line-${i}`} filter={filter}\n\n              handlePointOver={(event) => setHover(true)}\n              handlePointOut={(event) => setHover(false)}\n              hovered = {hovered}\n        />\n\n  </React.Fragment>\n  )\n}\n\nfunction Texts({filter}){\n   \n    ///Processing Filtered Data\n    let data_filtered = filterData(data, filter)\n\n\n    let textlist = [];\n  \n      //Draw Text\n      data_filtered.forEach((d, i)=>{\n  \n          let pX = - normLong(d.long),\n              pY = normLat(d.lat),\n              pZ = normZ(d.year),\n              pColor = groupColor[d.group];\n  \n          textlist.push(             \n            <MyText pX={pX} pY={pY} pZ={pZ} key={`text-${i}`} pColor={pColor} content={d.coname} filter={filter} i={i} />\n            )\n      })\n\n\n\n    return (\n        <React.Fragment>\n          \n          {textlist}\n         \n        </React.Fragment>\n      )\n    \n}\nexport default Texts;\n\n\n","//https://codesandbox.io/s/xl6mt?file=/package.json\n\nimport { createDerivedMaterial } from 'troika-three-utils'\n\nexport function createBillboardMaterial(baseMaterial, opts) {\n  return createDerivedMaterial(\n    baseMaterial,\n    Object.assign(\n      {\n        vertexMainOutro: `\nvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nvec3 scale = vec3(\n  length(modelViewMatrix[0].xyz),\n  length(modelViewMatrix[1].xyz),\n  length(modelViewMatrix[2].xyz)\n  );\n// size attenuation: scale *= -mvPosition.z * 0.2;\nmvPosition.xyz += position * scale;\ngl_Position = projectionMatrix * mvPosition;\n`\n      },\n      opts\n    )\n  )\n}"],"names":["Line","pX","pY","pZ","filter","handlePointOut","handlePointOver","hovered","geometry","useMemo","start","THREE","end","setFromPoints","onPointerOver","onPointerOut","onUpdate","line","computeLineDistances","color","opacity","transparent","linewidth","scale","dashSize","gapSize","MyText","pColor","content","i","useState","setHover","baseMaterial","createDerivedMaterial","Object","assign","vertexMainOutro","opts","billboardMaterial","useEffect","document","body","style","cursor","Text","anchorX","fontSize","position","material","outlineWidth","outlineOffsetX","outlineOffsetY","outlineOffsetZ","outlineBlur","outlineOpacity","outlineColor","event","data_filtered","filterData","data","textlist","forEach","d","normLong","long","normLat","lat","normZ","year","groupColor","group","push","coname"],"sourceRoot":""}